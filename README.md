# praktikum_new_diplom

Foodgram-project

### О проекте:

Проект Foodgram - социальная сеть в которой пользователи делятся своими рецептами.
В проекте реализованы 3 уровня доступа:
- Неавторизованный пользователь - может просматривать список рецептов и отделные рецепты, список пользователей и профиль отдельного пользователя, может зарегистрироваться по email и паролю. У каждого рецепта есть тэги,  фильтрация по тэгам осуществляется по принципу "или".
- Авторизованный пользователь - может совершать все действия неавторизованного пользователя, может менять свой пароль. Может создавать свои рецепты, выбор ингредиентов рецепта происходит  из предустановленного списка с поиском и фильтрацией по списку. Может добавлять любые рецепты в список избранных. Может подписываться на других пользователей проекта и в разделе подписок видеть рецепты этих пользователей. Может добавлять рецепты в список покупок. Может загрузить список покупок в виде pdf файла, при этом количество одинаковых ингредиентов из разных рецептов в списке покупок будет суммироваться.
- Администратор - может совершать все действия авторизованного пользователя. Имеет доступ к административной панели. В административной панели может отсортировать рецепты по популярности. Имеет полный доступ к созданию и удалению любых объектов проекта. Может менять пароли пользователей.

Авторизация пользователей ведется через токены.

### Компоненты проекта:
- Стандартная административная панель Django с дополнительным полем популярности рецептов с возможностью сортировки
- Приложение api
- Приложение recipes
- Приложение users
- Утилита создания pdf файла


Классы приложения reviews и их поля:
 
- Title:
    - name - название произведения - текстовое поле до 256 символов
    - year - год создания произведения - целое число от 0 до 2100
    - description - описание произведения - текстовое поле
    - category - обязательное поле с описанием категории произведения, связанное с моделью "Category", удаление связанного объекта Category невозможно пока есть хотя бы один объект Title этой категории
    - genre - необязательное поле, связанное с моделью "Genre", удаление связанного объекта Genre обнуляет это поле у объекта Title
- Category:
    - name - название категории - текстовое поле до 256 символов
    - slug - краткое наименование категории - до 50 символов
- Genre:
    - name - название жанра - текстовое поле до 256 символов
    - slug - краткое наименование жанра - до 50 символов

#### Основные адреса проекта:
Административная панель
```
http://127.0.0.1:8000/admin/
```
Основной адрес API:
```
http://127.0.0.1:8000/api/v1/
```
Документация по API:
```
http://127.0.0.1:8000/redoc/
```

### Как запустить проект в операционной системе Windows:

Клонировать репозиторий и перейти в него в командной строке:

```
git clone 
```
Перейти в корневую директорию проекта
```
cd api_yamdb
```

Cоздать и активировать виртуальное окружение:

```
python -m venv env
```

```
source venv/bin/activate
```

Установить зависимости из файла requirements.txt:

```
python -m pip install --upgrade pip
```

```
pip install -r requirements.txt
```

Выполнить миграции:

```
python manage.py migrate
```
Для управления пользователями и доступа в административную панель необходимо создать суперпользователя через командную строку и задать имя пользователя и пароль:

```
python manage.py create superuser
```


Запустить проект:

```
python manage.py runserver
```
После запуска проекта локально станут доступны Основные адреса проекта, там же можно найти примеры запросов и ответы.

### Авторизация пользователей
Авторизация пользователей ведется при помощи JWT токенов. Срок жизни токена - 1 час. После создания пользователя необходимо через api запросить JWT токены для работы и для смены/апдейта токена. Токен должен поступать в заголовке каждого запроса к api.

### Примеры запросов:
***Получение списка всех жанров***

Запрос: [GET] http://127.0.0.1:8000/api/v1/genres/

Ответ:
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "name": "string",
      "slug": "string"
    }
  ]
}
```

***Добавление жанра***

Запрос: [POST] http://127.0.0.1:8000/api/v1/genres/

Тело запроса:
```
{
  "name": "string",
  "slug": "string"
}
```
Ответ с кодом 201:
```
{
  "name": "string",
  "slug": "string"
}
```
Ответ с кодом 400:
```
{
  "field_name": [
    "string"
  ]
}
```

***Получение списка всех комментариев к отзыву***

Запрос: [GET] http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/

Параметры запроса:
```
title_id - ID произведения
review_id - ID отзыва
```
Ответ с кодом 201:
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "id": 0,
      "text": "string",
      "author": "string",
      "pub_date": "2023-06-07T14:15:22Z"
    }
  ]
}
```

***Добавление комментария к отзыву***

Запрос: [POST] http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/

Параметры запроса:
```
title_id - ID произведения
review_id - ID отзыва
```
Тело запроса:
```
{
  "text": "string"
}
```
Ответ с кодом 201:
```
{
  "id": 0,
  "text": "string",
  "author": "string",
  "pub_date": "2023-06-07T14:20:22Z"
}
```
